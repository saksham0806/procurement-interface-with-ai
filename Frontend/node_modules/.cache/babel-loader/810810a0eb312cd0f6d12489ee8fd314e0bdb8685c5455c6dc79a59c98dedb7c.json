{"ast":null,"code":"import React,{useState,useEffect}from'react';import axios from'axios';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ApprovalCenter=_ref=>{let{user}=_ref;const[pendingOrders,setPendingOrders]=useState([]);const[loading,setLoading]=useState(true);useEffect(()=>{fetchPendingOrders();},[]);const fetchPendingOrders=async()=>{try{const response=await axios.get('/api/purchase-orders');const orders=response.data.filter(order=>order.status==='pending');setPendingOrders(orders);}catch(error){console.error('Error fetching orders:',error);}finally{setLoading(false);}};const approveOrder=async orderId=>{try{await axios.put(\"/api/purchase-orders/\".concat(orderId,\"/approve\"),{status:'approved',comments:'Approved by '+user.name});alert('Purchase Order approved successfully!');fetchPendingOrders();}catch(error){console.error('Error approving order:',error);alert('Error approving order. Please try again.');}};const rejectOrder=async orderId=>{const comments=prompt('Please enter rejection reason:');if(comments){try{await axios.put(\"/api/purchase-orders/\".concat(orderId,\"/approve\"),{status:'rejected',comments:comments});alert('Purchase Order rejected.');fetchPendingOrders();}catch(error){console.error('Error rejecting order:',error);alert('Error rejecting order. Please try again.');}}};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"loading\",children:\"Loading pending orders...\"});}return/*#__PURE__*/_jsxs(\"div\",{className:\"approval-center\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Pending Approvals\"}),pendingOrders.length===0?/*#__PURE__*/_jsx(\"div\",{className:\"no-orders\",children:/*#__PURE__*/_jsx(\"p\",{children:\"No pending orders for approval.\"})}):/*#__PURE__*/_jsx(\"div\",{className:\"approval-grid\",children:pendingOrders.map(order=>{var _order$rfpId,_order$vendorId,_order$vendorId2,_order$buyerId,_order$buyerId2;return/*#__PURE__*/_jsxs(\"div\",{className:\"approval-card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"approval-header\",children:[/*#__PURE__*/_jsxs(\"h3\",{children:[\"PO: \",order.poNumber]}),/*#__PURE__*/_jsx(\"span\",{className:\"approval-status\",children:order.status})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"approval-details\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"detail-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"RFP:\"}),/*#__PURE__*/_jsx(\"span\",{children:(_order$rfpId=order.rfpId)===null||_order$rfpId===void 0?void 0:_order$rfpId.title})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Vendor:\"}),/*#__PURE__*/_jsxs(\"span\",{children:[(_order$vendorId=order.vendorId)===null||_order$vendorId===void 0?void 0:_order$vendorId.name,\" (\",(_order$vendorId2=order.vendorId)===null||_order$vendorId2===void 0?void 0:_order$vendorId2.company,\")\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Buyer:\"}),/*#__PURE__*/_jsxs(\"span\",{children:[(_order$buyerId=order.buyerId)===null||_order$buyerId===void 0?void 0:_order$buyerId.name,\" (\",(_order$buyerId2=order.buyerId)===null||_order$buyerId2===void 0?void 0:_order$buyerId2.company,\")\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Amount:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"amount\",children:[\"$\",order.totalAmount.toLocaleString()]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Created:\"}),/*#__PURE__*/_jsx(\"span\",{children:new Date(order.createdAt).toLocaleDateString()})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"approval-actions\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>approveOrder(order._id),className:\"btn btn-success\",children:\"Approve\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>rejectOrder(order._id),className:\"btn btn-danger\",children:\"Reject\"})]})]},order._id);})})]});};export default ApprovalCenter;","map":{"version":3,"names":["React","useState","useEffect","axios","jsx","_jsx","jsxs","_jsxs","ApprovalCenter","_ref","user","pendingOrders","setPendingOrders","loading","setLoading","fetchPendingOrders","response","get","orders","data","filter","order","status","error","console","approveOrder","orderId","put","concat","comments","name","alert","rejectOrder","prompt","className","children","length","map","_order$rfpId","_order$vendorId","_order$vendorId2","_order$buyerId","_order$buyerId2","poNumber","rfpId","title","vendorId","company","buyerId","totalAmount","toLocaleString","Date","createdAt","toLocaleDateString","onClick","_id"],"sources":["/run/media/Saksham/Saksham/Code/Projects/ai-supplies/Frontend/src/components/ApprovalCenter.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport axios from 'axios';\n\nconst ApprovalCenter = ({ user }) => {\n  const [pendingOrders, setPendingOrders] = useState([]);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    fetchPendingOrders();\n  }, []);\n\n  const fetchPendingOrders = async () => {\n    try {\n      const response = await axios.get('/api/purchase-orders');\n      const orders = response.data.filter(order => order.status === 'pending');\n      setPendingOrders(orders);\n    } catch (error) {\n      console.error('Error fetching orders:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const approveOrder = async (orderId) => {\n    try {\n      await axios.put(`/api/purchase-orders/${orderId}/approve`, {\n        status: 'approved',\n        comments: 'Approved by ' + user.name\n      });\n      alert('Purchase Order approved successfully!');\n      fetchPendingOrders();\n    } catch (error) {\n      console.error('Error approving order:', error);\n      alert('Error approving order. Please try again.');\n    }\n  };\n\n  const rejectOrder = async (orderId) => {\n    const comments = prompt('Please enter rejection reason:');\n    if (comments) {\n      try {\n        await axios.put(`/api/purchase-orders/${orderId}/approve`, {\n          status: 'rejected',\n          comments: comments\n        });\n        alert('Purchase Order rejected.');\n        fetchPendingOrders();\n      } catch (error) {\n        console.error('Error rejecting order:', error);\n        alert('Error rejecting order. Please try again.');\n      }\n    }\n  };\n\n  if (loading) {\n    return <div className=\"loading\">Loading pending orders...</div>;\n  }\n\n  return (\n    <div className=\"approval-center\">\n      <h2>Pending Approvals</h2>\n      {pendingOrders.length === 0 ? (\n        <div className=\"no-orders\">\n          <p>No pending orders for approval.</p>\n        </div>\n      ) : (\n        <div className=\"approval-grid\">\n          {pendingOrders.map((order) => (\n            <div key={order._id} className=\"approval-card\">\n              <div className=\"approval-header\">\n                <h3>PO: {order.poNumber}</h3>\n                <span className=\"approval-status\">{order.status}</span>\n              </div>\n              \n              <div className=\"approval-details\">\n                <div className=\"detail-item\">\n                  <label>RFP:</label>\n                  <span>{order.rfpId?.title}</span>\n                </div>\n                <div className=\"detail-item\">\n                  <label>Vendor:</label>\n                  <span>{order.vendorId?.name} ({order.vendorId?.company})</span>\n                </div>\n                <div className=\"detail-item\">\n                  <label>Buyer:</label>\n                  <span>{order.buyerId?.name} ({order.buyerId?.company})</span>\n                </div>\n                <div className=\"detail-item\">\n                  <label>Amount:</label>\n                  <span className=\"amount\">${order.totalAmount.toLocaleString()}</span>\n                </div>\n                <div className=\"detail-item\">\n                  <label>Created:</label>\n                  <span>{new Date(order.createdAt).toLocaleDateString()}</span>\n                </div>\n              </div>\n\n              <div className=\"approval-actions\">\n                <button\n                  onClick={() => approveOrder(order._id)}\n                  className=\"btn btn-success\"\n                >\n                  Approve\n                </button>\n                <button\n                  onClick={() => rejectOrder(order._id)}\n                  className=\"btn btn-danger\"\n                >\n                  Reject\n                </button>\n              </div>\n            </div>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default ApprovalCenter;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}